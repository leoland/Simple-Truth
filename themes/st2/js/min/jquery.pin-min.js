!function($){"use strict";$.fn.pin=function(t){var s=0,o=[],e=!1,i=$(window);t=t||{};var a=function(){for(var s=0,a=o.length;a>s;s++){var n=o[s];if(t.minWidth&&i.width()<=t.minWidth)n.parent().is(".pin-wrapper")&&n.unwrap(),n.css({width:"",left:"",top:"",position:""}),t.activeClass&&n.removeClass(t.activeClass),e=!0;else{e=!1;var p=t.containerSelector?n.closest(t.containerSelector):$(document.body),r=n.offset(),c=p.offset(),d=n.offsetParent().offset();n.parent().is(".pin-wrapper")||n.wrap("<div class='pin-wrapper'>");var f=$.extend({top:0,bottom:0},t.padding||{});n.data("pin",{pad:f,from:(t.containerSelector?c.top:r.top)-f.top,to:c.top+p.height()-n.outerHeight()-f.bottom,end:c.top+p.height(),parentTop:d.top}),n.css({width:n.outerWidth()}),n.parent().css("height",n.outerHeight())}}},n=function(){if(!e){s=i.scrollTop();for(var a=[],n=0,p=o.length;p>n;n++){var r=$(o[n]),c=r.data("pin");if(c){a.push(r);var d=c.from-c.pad.bottom,f=c.to-c.pad.top;d+r.outerHeight()>c.end?r.css("position",""):s>d&&f>s?(!("fixed"==r.css("position"))&&r.css({left:r.offset().left,top:c.pad.top}).css("position","fixed"),t.activeClass&&r.addClass(t.activeClass)):s>=f?(r.css({left:"",top:f-c.parentTop+c.pad.top}).css("position","absolute"),t.activeClass&&r.addClass(t.activeClass)):(r.css({position:"",top:"",left:""}),t.activeClass&&r.removeClass(t.activeClass))}}o=a}},p=function(){a(),n()};return this.each(function(){var t=$(this),s=$(this).data("pin")||{};s&&s.update||(o.push(t),$("img",this).one("load",a),s.update=p,$(this).data("pin",s))}),i.scroll(n),i.resize(function(){a()}),a(),i.load(p),this}}(jQuery);